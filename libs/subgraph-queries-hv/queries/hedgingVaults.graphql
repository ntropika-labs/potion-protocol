fragment VaultInfo on HedgingVault {
  id
  currentRound
  lastUnderlyingToShareRate
  lastUnderlyingsInvested
  lastShareToUnderlyingRate
  totalShares
}

fragment ActionInfo on PotionBuyAction {
  id
  cycleDurationSecs
  hedgingRate
  maxPremiumPercentage
  maxSwapDurationSecs
  nextCycleStartTimestamp
  premiumSlippage
  strikePercentage
  swapSlippage
}

fragment TokenInfo on Token {
  id
  name
  symbol
  decimals
}

fragment DepositTicketInfo on DepositTicket {
  amountRemaining
  amountRedeemed
  shares
  sharesRemaining
  sharesRedeemed
}

fragment WithdrawalTicketInfo on WithdrawalTicket {
  amountRemaining
  amountRedeemed
  underlyings
  underlyingsRemaining
  underlyingsRedeemed
}

query getHedgingVault($vault: ID!, $investor: String!) {
  hedgingVault(id: $vault) {
    ...VaultInfo
    action {
      ...ActionInfo
    }
    underlying {
      ...TokenInfo
    }
    shareToken {
      ...TokenInfo
    }
    rounds(orderBy: roundNumber) {
      roundNumber
      underlyingToShareRate
      shareToUnderlyingRate
      depositTickets(where: { investor: $investor }) {
        ...DepositTicketInfo
      }
      withdrawalTickets(where: { investor: $investor }) {
        ...WithdrawalTicketInfo
      }
    }
  }
}

query getHedgingVaults($investor: String) {
  hedgingVaults {
    ...VaultInfo
    action {
      ...ActionInfo
    }
    underlying {
      ...TokenInfo
    }
    shareToken {
      ...TokenInfo
    }
    rounds(orderBy: roundNumber) {
      depositTickets(where: { investor: $investor }) {
        id
      }
    }
  }
}
