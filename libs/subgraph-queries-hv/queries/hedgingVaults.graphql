fragment VaultInfo on HedgingVault {
  id
  currentRound
  lastAssetToShareRate
  lastAssetsInvested
  lastShareToAssetRate
  totalAssets
}

fragment ActionInfo on PotionBuyAction {
  id
  cycleDurationSecs
  hedgingRate
  maxPremiumPercentage
  maxSwapDurationSecs
  nextCycleStartTimestamp
  premiumSlippage
  strikePercentage
  swapSlippage
}

fragment TokenInfo on Token {
  id
  name
  symbol
  decimals
}

query getHedgingVault($vault: ID!, $investor: String!) {
  hedgingVault(id: $vault) {
    ...VaultInfo
    action {
      ...ActionInfo
    }
    asset {
      ...TokenInfo
    }
    shareToken {
      ...TokenInfo
    }
    rounds(orderBy: roundNumber) {
      roundNumber
      assetToShareRate
      shareToAssetRate
      depositRequests(where: { investor: $investor }) {
        amount
        amountRedeemed
        shares
        remainingShares
      }
      withdrawalRequests(where: { investor: $investor }) {
        amount
        amountRedeemed
        assets
        remainingAssets
      }
    }
  }
}

query getHedgingVaults {
  hedgingVaults {
    ...VaultInfo
    action {
      ...ActionInfo
    }
    asset {
      ...TokenInfo
    }
    shareToken {
      ...TokenInfo
    }
  }
}
