query getPoolsFromCriteria(
  $underlyingAddress: String
  $minDuration: BigInt
  $minStrike: BigDecimal
) {
  criterias(
    where: {
      underlyingAsset: $underlyingAddress
      maxDurationInDays_gte: $minDuration
      maxStrikePercent_gte: $minStrike
    }
  ) {
    isPut
    maxStrikePercent
    maxDurationInDays
    strikeAsset {
      address
    }
    criteriaSets {
      criteriaSet {
        templates {
          curve {
            id
            a
            b
            c
            d
            maxUtil
          }
          pools(first: 1000, orderBy: averageCost, orderDirection: asc) {
            id
            size
            locked
            unlocked
            utilization
            lp
            poolId
          }
        }
      }
    }
  }
}

query getNumberOfPoolsFromUser($lp: Bytes, $ids: [ID!]) {
  pools(where: { lp: $lp, id_not_in: $ids }, first: 1000) {
    id
  }
}
query getPoolsFromUser($lp: Bytes, $ids: [ID!]) {
  pools(where: { lp: $lp, id_not_in: $ids }, first: 1000) {
    id
    pnlPercentage
    poolId
    size
    utilization
    template {
      criteriaSet {
        criterias {
          criteria {
            underlyingAsset {
              name
              symbol
              address
            }
          }
        }
      }
    }
  }
}

query getPoolById($id: ID!) {
  pool(id: $id) {
    id
    poolId
    lp
    size
    locked
    pnlPercentage
    snapshots {
      id
      size
      locked
      pnlPercentage
      actionAmount
      actionType
      timestamp
      utilization
      liquidityAtTrades
    }
    template {
      curve {
        id
        a
        b
        c
        d
        maxUtil
      }
      criteriaSet {
        criterias {
          criteria {
            id
            underlyingAsset {
              address
              decimals
              symbol
              name
            }
            strikeAsset {
              address
              decimals
              symbol
              name
            }
            isPut
            maxStrikePercent
            maxDurationInDays
          }
        }
      }
    }
  }
}
