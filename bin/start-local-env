#!/bin/bash
echo "Run and deploy the contracts and subgraph on local ganache" &&
docker compose up -d -V && echo "containers started..." &&
bin/wait-for-it localhost:8545 && sleep 2 && echo "ganache is ready" &&
yarn nx run simple-erc20:deploy-local && echo "smart contracts deployed" &&
yarn nx run subgraph:prepare-local && echo "subgraph.yaml is ready..." &&
sleep 3 && bin/wait-for-it localhost:8020 && sleep 10 && echo "graph-node is ready" &&
yarn nx run subgraph:create-local && echo "subgraph created" &&
sleep 3 && yarn nx run subgraph:deploy-local --version-label 0.0.1 && echo "subgraph deployed"
