<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for openzeppelin/ERC4626Upgradeable.sol</title>
    <meta charset="utf-8" />
    <link rel="stylesheet" href="../prettify.css" />
    <link rel="stylesheet" href="../base.css" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style type='text/css'>
        .coverage-summary .sorter {
            background-image: url(../sort-arrow-sprite.png);
        }
    </style>
</head>
<body>
<div class='wrapper'>
  <div class='pad1'>
    <h1>
      <a href="../index.html">all files</a> / <a href="index.html">openzeppelin/</a> ERC4626Upgradeable.sol
    </h1>
    <div class='clearfix'>
      <div class='fl pad1y space-right2'>
        <span class="strong">0% </span>
        <span class="quiet">Statements</span>
        <span class='fraction'>0/43</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">0% </span>
        <span class="quiet">Branches</span>
        <span class='fraction'>0/10</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">0% </span>
        <span class="quiet">Functions</span>
        <span class='fraction'>0/23</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">0% </span>
        <span class="quiet">Lines</span>
        <span class='fraction'>0/43</span>
      </div>
    </div>
  </div>
  <div class='status-line low'></div>
<pre><table class="coverage">
<tr><td class="line-count quiet">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228</td><td class="line-coverage quiet"><span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">// SPDX-License-Identifier: MIT
&nbsp;
pragma solidity ^0.8.0;
&nbsp;
import "@openzeppelin/contracts-upgradeable/token/ERC20/ERC20Upgradeable.sol";
import "@openzeppelin/contracts-upgradeable/token/ERC20/utils/SafeERC20Upgradeable.sol";
import "@openzeppelin/contracts-upgradeable/utils/math/MathUpgradeable.sol";
import "@openzeppelin/contracts-upgradeable/proxy/utils/Initializable.sol";
import "./IERC4626Upgradeable.sol";
&nbsp;
/**
 * @dev Implementation of the ERC4626 "Tokenized Vault Standard" as defined in
 * https://eips.ethereum.org/EIPS/eip-4626[EIP-4626].
 *
 * This extension allows the minting and burning of "shares" (represented using the ERC20 inheritance) in exchange for
 * underlying "assets" through standardized {deposit}, {mint}, {redeem} and {burn} workflows. This contract extends
 * the ERC20 standard. Any additional extensions included along it would affect the "shares" token represented by this
 * contract and not the "assets" token which is an independent contract.
 *
 * _Available since v4.7._
 */
abstract contract ERC4626Upgradeable is Initializable, ERC20Upgradeable, IERC4626Upgradeable {
    using MathUpgradeable for uint256;
&nbsp;
    IERC20MetadataUpgradeable private _asset;
&nbsp;
    /**
     * @dev Set the underlying asset contract. This must be an ERC20-compatible contract (ERC20 or ERC777).
     */
<span class="fstat-no" title="function not covered" >    function __ERC4626_init(IERC20MetadataUpgradeable asset_) internal onlyInitializing {</span>
<span class="cstat-no" title="statement not covered" >        __ERC4626_init_unchained(asset_)</span>;
    }
&nbsp;
<span class="fstat-no" title="function not covered" >    function __ERC4626_init_unchained(IERC20MetadataUpgradeable asset_) internal onlyInitializing {</span>
<span class="cstat-no" title="statement not covered" >        _asset = asset_</span>;
    }
&nbsp;
    /** @dev See {IERC4262-asset} */
<span class="fstat-no" title="function not covered" >    function asset() public view virtual override returns (address) {</span>
<span class="cstat-no" title="statement not covered" >        return address(_asset);</span>
    }
&nbsp;
    /** @dev See {IERC4262-totalAssets} */
<span class="fstat-no" title="function not covered" >    function totalAssets() public view virtual override returns (uint256) {</span>
<span class="cstat-no" title="statement not covered" >        return _asset.balanceOf(address(this));</span>
    }
&nbsp;
    /** @dev See {IERC4262-convertToShares} */
<span class="fstat-no" title="function not covered" >    function convertToShares(uint256 assets) public view virtual override returns (uint256 shares) {</span>
<span class="cstat-no" title="statement not covered" >        return _convertToShares(assets);</span>
    }
&nbsp;
    /** @dev See {IERC4262-convertToAssets} */
<span class="fstat-no" title="function not covered" >    function convertToAssets(uint256 shares) public view virtual override returns (uint256 assets) {</span>
<span class="cstat-no" title="statement not covered" >        return _convertToAssets(shares);</span>
    }
&nbsp;
    /** @dev See {IERC4262-maxDeposit} */
<span class="fstat-no" title="function not covered" >    function maxDeposit(address) public view virtual override returns (uint256) {</span>
<span class="cstat-no" title="statement not covered" >        return _isVaultCollateralized() ? type(uint256).max : 0;</span>
    }
&nbsp;
    /** @dev See {IERC4262-maxMint} */
<span class="fstat-no" title="function not covered" >    function maxMint(address) public view virtual override returns (uint256) {</span>
<span class="cstat-no" title="statement not covered" >        return type(uint256).max;</span>
    }
&nbsp;
    /** @dev See {IERC4262-maxWithdraw} */
<span class="fstat-no" title="function not covered" >    function maxWithdraw(address owner) public view virtual override returns (uint256) {</span>
<span class="cstat-no" title="statement not covered" >        return _convertToAssets(balanceOf(owner));</span>
    }
&nbsp;
    /** @dev See {IERC4262-maxRedeem} */
<span class="fstat-no" title="function not covered" >    function maxRedeem(address owner) public view virtual override returns (uint256) {</span>
<span class="cstat-no" title="statement not covered" >        return balanceOf(owner);</span>
    }
&nbsp;
    /** @dev See {IERC4262-previewDeposit} */
<span class="fstat-no" title="function not covered" >    function previewDeposit(uint256 assets) public view virtual override returns (uint256) {</span>
<span class="cstat-no" title="statement not covered" >        return _convertToShares(assets);</span>
    }
&nbsp;
    /** @dev See {IERC4262-previewMint} */
<span class="fstat-no" title="function not covered" >    function previewMint(uint256 shares) public view virtual override returns (uint256) {</span>
<span class="cstat-no" title="statement not covered" >        return _convertToAssets(shares);</span>
    }
&nbsp;
    /** @dev See {IERC4262-previewWithdraw} */
<span class="fstat-no" title="function not covered" >    function previewWithdraw(uint256 assets) public view virtual override returns (uint256) {</span>
<span class="cstat-no" title="statement not covered" >        return _convertToShares(assets);</span>
    }
&nbsp;
    /** @dev See {IERC4262-previewRedeem} */
<span class="fstat-no" title="function not covered" >    function previewRedeem(uint256 shares) public view virtual override returns (uint256) {</span>
<span class="cstat-no" title="statement not covered" >        return _convertToAssets(shares);</span>
    }
&nbsp;
    /** @dev See {IERC4262-deposit} */
<span class="fstat-no" title="function not covered" >    function deposit(uint256 assets, address receiver) public virtual override returns (uint256) {</span>
<span class="cstat-no" title="statement not covered" >        require(assets &lt;= maxDeposit(receiver), "ERC4626: deposit more than max")</span>;
&nbsp;
<span class="cstat-no" title="statement not covered" >        uint256 shares = previewDeposit(assets);</span>
<span class="cstat-no" title="statement not covered" >        _deposit(_msgSender(), receiver, assets, shares)</span>;
&nbsp;
<span class="cstat-no" title="statement not covered" >        return shares;</span>
    }
&nbsp;
    /** @dev See {IERC4262-mint} */
<span class="fstat-no" title="function not covered" >    function mint(uint256 shares, address receiver) public virtual override returns (uint256) {</span>
<span class="cstat-no" title="statement not covered" >        require(shares &lt;= maxMint(receiver), "ERC4626: mint more than max")</span>;
&nbsp;
<span class="cstat-no" title="statement not covered" >        uint256 assets = previewMint(shares);</span>
<span class="cstat-no" title="statement not covered" >        _deposit(_msgSender(), receiver, assets, shares)</span>;
&nbsp;
<span class="cstat-no" title="statement not covered" >        return assets;</span>
    }
&nbsp;
    /** @dev See {IERC4262-withdraw} */
<span class="fstat-no" title="function not covered" >    function withdraw(</span>
        uint256 assets,
        address receiver,
        address owner
    ) public virtual override returns (uint256) {
<span class="cstat-no" title="statement not covered" >        require(assets &lt;= maxWithdraw(owner), "ERC4626: withdraw more than max")</span>;
&nbsp;
<span class="cstat-no" title="statement not covered" >        uint256 shares = previewWithdraw(assets);</span>
<span class="cstat-no" title="statement not covered" >        _withdraw(_msgSender(), receiver, owner, assets, shares)</span>;
&nbsp;
<span class="cstat-no" title="statement not covered" >        return shares;</span>
    }
&nbsp;
    /** @dev See {IERC4262-redeem} */
<span class="fstat-no" title="function not covered" >    function redeem(</span>
        uint256 shares,
        address receiver,
        address owner
    ) public virtual override returns (uint256) {
<span class="cstat-no" title="statement not covered" >        require(shares &lt;= maxRedeem(owner), "ERC4626: redeem more than max")</span>;
&nbsp;
<span class="cstat-no" title="statement not covered" >        uint256 assets = previewRedeem(shares);</span>
<span class="cstat-no" title="statement not covered" >        _withdraw(_msgSender(), receiver, owner, assets, shares)</span>;
&nbsp;
<span class="cstat-no" title="statement not covered" >        return assets;</span>
    }
&nbsp;
    /**
     * @dev Internal convertion function (from assets to shares) with support for rounding direction
     *
     * Will revert if assets &gt; 0, totalSupply &gt; 0 and totalAssets = 0. That corresponds to a case where any asset
     * would represent an infinite amout of shares.
     */
<span class="fstat-no" title="function not covered" >    function _convertToShares(uint256 assets) internal view virtual returns (uint256 shares) {</span>
<span class="cstat-no" title="statement not covered" >        uint256 supply = totalSupply();</span>
<span class="cstat-no" title="statement not covered" >        return</span>
            (assets == 0 || supply == 0)
                ? (assets * (10**decimals())) / (10**_asset.decimals())
                : (assets * supply) / totalAssets();
    }
&nbsp;
    /**
     * @dev Internal convertion function (from shares to assets) with support for rounding direction
     */
<span class="fstat-no" title="function not covered" >    function _convertToAssets(uint256 shares) internal view virtual returns (uint256 assets) {</span>
<span class="cstat-no" title="statement not covered" >        uint256 supply = totalSupply();</span>
<span class="cstat-no" title="statement not covered" >        return</span>
            (supply == 0) ? (shares * (10**_asset.decimals())) / (10**decimals()) : (shares * totalAssets()) / supply;
    }
&nbsp;
    /**
     * @dev Deposit/mint common workflow
     */
<span class="fstat-no" title="function not covered" >    function _deposit(</span>
        address caller,
        address receiver,
        uint256 assets,
        uint256 shares
    ) private {
        // If _asset is ERC777, `transferFrom` can trigger a reenterancy BEFORE the transfer happens through the
        // `tokensToSend` hook. On the other hand, the `tokenReceived` hook, that is triggered after the transfer,
        // calls the vault, which is assumed not malicious.
        //
        // Conclusion: we need to do the transfer before we mint so that any reentrancy would happen before the
        // assets are transfered and before the shares are minted, which is a valid state.
        // slither-disable-next-line reentrancy-no-eth
<span class="cstat-no" title="statement not covered" >        SafeERC20Upgradeable.safeTransferFrom(_asset, caller, address(this), assets)</span>;
<span class="cstat-no" title="statement not covered" >        _mint(receiver, shares)</span>;
&nbsp;
<span class="cstat-no" title="statement not covered" >        emit Deposit(caller, receiver, assets, shares);</span>
    }
&nbsp;
    /**
     * @dev Withdraw/redeem common workflow
     */
<span class="fstat-no" title="function not covered" >    function _withdraw(</span>
        address caller,
        address receiver,
        address owner,
        uint256 assets,
        uint256 shares
    ) private {
<span class="cstat-no" title="statement not covered" >        if (caller != owner) {</span>
<span class="cstat-no" title="statement not covered" >            _spendAllowance(owner, caller, shares)</span>;
        }
&nbsp;
        // If _asset is ERC777, `transfer` can trigger trigger a reentrancy AFTER the transfer happens through the
        // `tokensReceived` hook. On the other hand, the `tokensToSend` hook, that is triggered before the transfer,
        // calls the vault, which is assumed not malicious.
        //
        // Conclusion: we need to do the transfer after the burn so that any reentrancy would happen after the
        // shares are burned and after the assets are transfered, which is a valid state.
<span class="cstat-no" title="statement not covered" >        _burn(owner, shares)</span>;
<span class="cstat-no" title="statement not covered" >        SafeERC20Upgradeable.safeTransfer(_asset, receiver, assets)</span>;
&nbsp;
<span class="cstat-no" title="statement not covered" >        emit Withdraw(caller, receiver, owner, assets, shares);</span>
    }
&nbsp;
<span class="fstat-no" title="function not covered" >    function _isVaultCollateralized() private view returns (bool) {</span>
<span class="cstat-no" title="statement not covered" >        return totalAssets() &gt; 0 || totalSupply() == 0;</span>
    }
&nbsp;
    /**
     * @dev This empty reserved space is put in place to allow future versions to add new
     * variables without shifting down storage in the inheritance chain.
     * See https://docs.openzeppelin.com/contracts/4.x/upgradeable#storage_gaps
     */
    uint256[49] private __gap;
}
&nbsp;</pre></td></tr>
</table></pre>
<div class='push'></div><!-- for sticky footer -->
</div><!-- /wrapper -->
<div class='footer quiet pad2 space-top1 center small'>
  Code coverage
  generated by <a href="http://istanbul-js.org/" target="_blank">istanbul</a> at Tue Jun 28 2022 16:25:47 GMT+0200 (Central European Summer Time)
</div>
</div>
<script src="../prettify.js"></script>
<script>
window.onload = function () {
        if (typeof prettyPrint === 'function') {
            prettyPrint();
        }
};
</script>
<script src="../sorter.js"></script>
</body>
</html>
