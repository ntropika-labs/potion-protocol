<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for contracts/PotionLiquidityPool.sol</title>
    <meta charset="utf-8" />
    <link rel="stylesheet" href="../prettify.css" />
    <link rel="stylesheet" href="../base.css" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style type='text/css'>
        .coverage-summary .sorter {
            background-image: url(../sort-arrow-sprite.png);
        }
    </style>
</head>
<body>
<div class='wrapper'>
  <div class='pad1'>
    <h1>
      <a href="../index.html">all files</a> / <a href="index.html">contracts/</a> PotionLiquidityPool.sol
    </h1>
    <div class='clearfix'>
      <div class='fl pad1y space-right2'>
        <span class="strong">99.57% </span>
        <span class="quiet">Statements</span>
        <span class='fraction'>231/232</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">67.86% </span>
        <span class="quiet">Branches</span>
        <span class='fraction'>57/84</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">100% </span>
        <span class="quiet">Functions</span>
        <span class='fraction'>41/41</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">99.14% </span>
        <span class="quiet">Lines</span>
        <span class='fraction'>231/233</span>
      </div>
    </div>
  </div>
  <div class='status-line high'></div>
<pre><table class="coverage">
<tr><td class="line-count quiet">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286
287
288
289
290
291
292
293
294
295
296
297
298
299
300
301
302
303
304
305
306
307
308
309
310
311
312
313
314
315
316
317
318
319
320
321
322
323
324
325
326
327
328
329
330
331
332
333
334
335
336
337
338
339
340
341
342
343
344
345
346
347
348
349
350
351
352
353
354
355
356
357
358
359
360
361
362
363
364
365
366
367
368
369
370
371
372
373
374
375
376
377
378
379
380
381
382
383
384
385
386
387
388
389
390
391
392
393
394
395
396
397
398
399
400
401
402
403
404
405
406
407
408
409
410
411
412
413
414
415
416
417
418
419
420
421
422
423
424
425
426
427
428
429
430
431
432
433
434
435
436
437
438
439
440
441
442
443
444
445
446
447
448
449
450
451
452
453
454
455
456
457
458
459
460
461
462
463
464
465
466
467
468
469
470
471
472
473
474
475
476
477
478
479
480
481
482
483
484
485
486
487
488
489
490
491
492
493
494
495
496
497
498
499
500
501
502
503
504
505
506
507
508
509
510
511
512
513
514
515
516
517
518
519
520
521
522
523
524
525
526
527
528
529
530
531
532
533
534
535
536
537
538
539
540
541
542
543
544
545
546
547
548
549
550
551
552
553
554
555
556
557
558
559
560
561
562
563
564
565
566
567
568
569
570
571
572
573
574
575
576
577
578
579
580
581
582
583
584
585
586
587
588
589
590
591
592
593
594
595
596
597
598
599
600
601
602
603
604
605
606
607
608
609
610
611
612
613
614
615
616
617
618
619
620
621
622
623
624
625
626
627
628
629
630
631
632
633
634
635
636
637
638
639
640
641
642
643
644
645
646
647
648
649
650
651
652
653
654
655
656
657
658
659
660
661
662
663
664
665
666
667
668
669
670
671
672
673
674
675
676
677
678
679
680
681
682
683
684
685
686
687
688
689
690
691
692
693
694
695
696
697
698
699
700
701
702
703
704
705
706
707
708
709
710
711
712
713
714
715
716
717
718
719
720
721
722
723
724
725
726
727
728
729
730
731
732
733
734
735
736
737
738
739
740
741
742
743
744
745
746
747
748
749
750
751
752
753
754
755
756
757
758
759
760
761
762
763
764
765
766
767
768
769
770
771
772
773
774
775
776
777
778
779
780
781
782
783
784
785
786
787
788
789
790
791
792
793
794
795
796
797
798
799
800
801
802
803
804
805
806
807
808
809
810
811
812
813
814
815
816
817
818
819
820
821
822
823
824
825
826
827
828
829
830
831
832
833
834
835
836
837
838
839
840
841
842
843
844
845
846
847
848
849
850
851
852
853
854
855
856
857
858
859
860
861
862
863
864
865
866
867
868
869
870
871
872
873
874
875
876
877
878
879
880
881
882
883
884
885
886
887
888
889
890
891
892
893
894
895
896
897
898
899
900
901
902
903
904
905
906
907
908
909
910
911
912
913
914
915
916
917
918
919
920
921
922
923
924
925
926
927
928
929
930
931
932
933
934
935
936
937
938
939
940
941
942
943
944
945
946
947
948
949
950
951
952
953
954
955
956
957
958
959
960
961
962
963
964
965
966
967
968
969
970
971
972
973
974
975
976
977
978
979
980
981
982
983
984
985
986
987
988
989
990
991
992
993
994
995
996
997
998
999
1000
1001
1002
1003
1004
1005
1006
1007
1008
1009
1010
1011
1012
1013
1014
1015
1016
1017
1018
1019
1020
1021
1022
1023
1024
1025
1026
1027
1028
1029
1030
1031
1032
1033
1034
1035
1036
1037
1038
1039
1040
1041
1042
1043
1044
1045
1046
1047
1048
1049
1050
1051
1052
1053
1054
1055
1056
1057
1058
1059
1060
1061
1062
1063
1064
1065
1066
1067
1068
1069
1070
1071
1072
1073
1074
1075
1076
1077
1078
1079
1080
1081
1082
1083
1084
1085
1086
1087
1088
1089
1090
1091
1092
1093
1094
1095
1096
1097
1098
1099
1100
1101
1102
1103
1104
1105
1106
1107
1108
1109
1110
1111
1112
1113
1114
1115
1116
1117
1118
1119
1120
1121
1122
1123
1124
1125
1126
1127
1128
1129
1130
1131</td><td class="line-coverage quiet"><span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">180×</span>
<span class="cline-any cline-yes">180×</span>
<span class="cline-any cline-yes">180×</span>
<span class="cline-any cline-yes">180×</span>
<span class="cline-any cline-yes">180×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">180×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">180×</span>
<span class="cline-any cline-yes">180×</span>
<span class="cline-any cline-yes">180×</span>
<span class="cline-any cline-yes">180×</span>
<span class="cline-any cline-yes">180×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">3×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">3×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">4×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">66×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">66×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">24×</span>
<span class="cline-any cline-yes">24×</span>
<span class="cline-any cline-yes">24×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">24×</span>
<span class="cline-any cline-yes">24×</span>
<span class="cline-any cline-yes">24×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">56×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">56×</span>
<span class="cline-any cline-yes">56×</span>
<span class="cline-any cline-yes">56×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">56×</span>
<span class="cline-any cline-yes">56×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">56×</span>
<span class="cline-any cline-yes">68×</span>
<span class="cline-any cline-yes">68×</span>
<span class="cline-any cline-yes">68×</span>
<span class="cline-any cline-yes">65×</span>
<span class="cline-any cline-yes">65×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">53×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">131×</span>
<span class="cline-any cline-yes">131×</span>
<span class="cline-any cline-yes">131×</span>
<span class="cline-any cline-yes">131×</span>
<span class="cline-any cline-yes">128×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">128×</span>
<span class="cline-any cline-yes">128×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">128×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">81×</span>
<span class="cline-any cline-yes">81×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">81×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">81×</span>
<span class="cline-any cline-yes">81×</span>
<span class="cline-any cline-yes">81×</span>
<span class="cline-any cline-yes">81×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">81×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">43×</span>
<span class="cline-any cline-yes">43×</span>
<span class="cline-any cline-yes">43×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">43×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">54×</span>
<span class="cline-any cline-yes">54×</span>
<span class="cline-any cline-yes">53×</span>
<span class="cline-any cline-yes">53×</span>
<span class="cline-any cline-yes">53×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">13×</span>
<span class="cline-any cline-yes">13×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">13×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">56×</span>
<span class="cline-any cline-yes">55×</span>
<span class="cline-any cline-yes">53×</span>
<span class="cline-any cline-yes">53×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">67×</span>
<span class="cline-any cline-yes">66×</span>
<span class="cline-any cline-yes">65×</span>
<span class="cline-any cline-yes">65×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">25×</span>
<span class="cline-any cline-yes">25×</span>
<span class="cline-any cline-yes">23×</span>
<span class="cline-any cline-yes">23×</span>
<span class="cline-any cline-yes">23×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">41×</span>
<span class="cline-any cline-yes">41×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">41×</span>
<span class="cline-any cline-yes">41×</span>
<span class="cline-any cline-yes">41×</span>
<span class="cline-any cline-yes">41×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">41×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">41×</span>
<span class="cline-any cline-yes">41×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">41×</span>
<span class="cline-any cline-yes">41×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">41×</span>
<span class="cline-any cline-yes">41×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">41×</span>
<span class="cline-any cline-yes">41×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">41×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">41×</span>
<span class="cline-any cline-yes">65×</span>
<span class="cline-any cline-yes">65×</span>
<span class="cline-any cline-yes">65×</span>
<span class="cline-any cline-yes">64×</span>
<span class="cline-any cline-yes">64×</span>
<span class="cline-any cline-yes">63×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">63×</span>
<span class="cline-any cline-yes">63×</span>
<span class="cline-any cline-yes">63×</span>
<span class="cline-any cline-yes">63×</span>
<span class="cline-any cline-yes">63×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">63×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">61×</span>
<span class="cline-any cline-yes">61×</span>
<span class="cline-any cline-yes">61×</span>
<span class="cline-any cline-yes">61×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">61×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">37×</span>
<span class="cline-any cline-yes">33×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">33×</span>
<span class="cline-any cline-yes">33×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">33×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">33×</span>
<span class="cline-any cline-yes">33×</span>
<span class="cline-any cline-yes">33×</span>
<span class="cline-any cline-yes">33×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">4×</span>
<span class="cline-any cline-yes">4×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">4×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">4×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">4×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">4×</span>
<span class="cline-any cline-yes">4×</span>
<span class="cline-any cline-yes">4×</span>
<span class="cline-any cline-yes">4×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">4×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">20×</span>
<span class="cline-any cline-yes">20×</span>
<span class="cline-any cline-yes">20×</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">20×</span>
<span class="cline-any cline-yes">10×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">10×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">10×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">20×</span>
<span class="cline-any cline-yes">20×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">4×</span>
<span class="cline-any cline-yes">4×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">4×</span>
<span class="cline-any cline-yes">12×</span>
<span class="cline-any cline-yes">12×</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">12×</span>
<span class="cline-any cline-yes">12×</span>
<span class="cline-any cline-yes">12×</span>
<span class="cline-any cline-yes">12×</span>
<span class="cline-any cline-yes">12×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">4×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">7×</span>
<span class="cline-any cline-yes">7×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">7×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">9×</span>
<span class="cline-any cline-yes">9×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">9×</span>
<span class="cline-any cline-yes">9×</span>
<span class="cline-any cline-yes">9×</span>
<span class="cline-any cline-yes">15×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">9×</span>
<span class="cline-any cline-yes">9×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">25×</span>
<span class="cline-any cline-yes">25×</span>
<span class="cline-any cline-yes">24×</span>
<span class="cline-any cline-yes">23×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">54×</span>
<span class="cline-any cline-yes">54×</span>
<span class="cline-any cline-yes">54×</span>
<span class="cline-any cline-yes">54×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">12×</span>
<span class="cline-any cline-yes">12×</span>
<span class="cline-any cline-yes">12×</span>
<span class="cline-any cline-yes">12×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">12×</span>
<span class="cline-any cline-yes">12×</span>
<span class="cline-any cline-yes">12×</span>
<span class="cline-any cline-yes">12×</span>
<span class="cline-any cline-yes">12×</span>
<span class="cline-any cline-yes">12×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">48×</span>
<span class="cline-any cline-yes">48×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">43×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">37×</span>
<span class="cline-any cline-yes">37×</span>
<span class="cline-any cline-yes">37×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">37×</span>
<span class="cline-any cline-yes">37×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">37×</span>
<span class="cline-any cline-yes">37×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">43×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">63×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">63×</span>
<span class="cline-any cline-yes">63×</span>
<span class="cline-any cline-yes">61×</span>
<span class="cline-any cline-yes">61×</span>
<span class="cline-any cline-yes">61×</span>
<span class="cline-any cline-yes">61×</span>
<span class="cline-any cline-yes">61×</span>
<span class="cline-any cline-yes">61×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">155×</span>
<span class="cline-any cline-yes">155×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">155×</span>
<span class="cline-any cline-yes">155×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">152×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">3×</span>
<span class="cline-any cline-yes">3×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">155×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">131×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">128×</span>
<span class="cline-any cline-yes">127×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">126×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">126×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">126×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">202×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">118×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">84×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">84×</span>
<span class="cline-any cline-yes">84×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">84×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">3×</span>
<span class="cline-any cline-yes">3×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">/**
 * SPDX-License-Identifier: Apache-2.0
 */
pragma solidity 0.8.4;
&nbsp;
import { ICurveManager } from "./interfaces/ICurveManager.sol";
import { ICriteriaManager } from "./interfaces/ICriteriaManager.sol";
import { ControllerInterface } from "./packages/opynInterface/OpynControllerInterface.sol";
import { OtokenInterface } from "./packages/opynInterface/OtokenInterface.sol";
import { OtokenFactoryInterface } from "./packages/opynInterface/OtokenFactoryInterface.sol";
import { Actions } from "./packages/opynInterface/ActionsInterface.sol";
import { AddressBookInterface } from "./packages/opynInterface/AddressBookInterface.sol";
import { WhitelistInterface } from "./packages/opynInterface/WhitelistInterface.sol";
import { OracleInterface } from "./packages/opynInterface/OracleInterface.sol";
import { FixedPointInt256 as FPI } from "./packages/opynInterface/FixedPointInt256.sol";
import { OpynActionsLibrary as ActionsLib } from "./OpynActionsLibrary.sol";
import { PausableUpgradeable } from "@openzeppelin/contracts-upgradeable/security/PausableUpgradeable.sol";
import { OwnableUpgradeable } from "@openzeppelin/contracts-upgradeable/access/OwnableUpgradeable.sol";
import { IERC20MetadataUpgradeable as ERC20Interface } from "@openzeppelin/contracts-upgradeable/token/ERC20/extensions/IERC20MetadataUpgradeable.sol";
import { SafeERC20Upgradeable as SafeERC20 } from "@openzeppelin/contracts-upgradeable/token/ERC20/utils/SafeERC20Upgradeable.sol";
import { IERC20Upgradeable as IERC20 } from "@openzeppelin/contracts-upgradeable/token/ERC20/IERC20Upgradeable.sol";
import { PRBMathSD59x18 } from "./packages/PRBMathSD59x18.sol";
&nbsp;
/**
 * @title PotionLiquidityPool
 * @notice It allows LPs to deposit, withdraw and configure Pools Of Capital. Buyer can buy OTokens.
 */
contract PotionLiquidityPool is PausableUpgradeable, OwnableUpgradeable {
    // This contract performs significant fixed point arithmetic, and uses TWO DIFFERENT maths libraries for that:
    // 1. Whenever we do a calculation that involves an exchange rate (e.g. the ETH price denominated in USDC) we use the same
    //    library as Opyn. This is so that we can more easily compare our code and results to Opyn's, and perhaps replace our
    //    code with theirs if/when they extend their public interfaces.
    // 2. For our more complex premium calculation logic, we make use of the more powerful PRBMathSD59x18 library. This handles
    //    exponentials and logarithms for us. We also use it for util calculations, because utilisations are used as input in
    //    premium calculations.
    using FPI for FPI.FixedPointInt;
    using PRBMathSD59x18 for int256;
    using SafeERC20 for IERC20;
&nbsp;
    /// @dev Strike prices from an otoken contract are expressed with 8 decimals
    uint256 internal constant STRIKE_PRICE_DECIMALS = 8;
    /// @dev Oracle prices are always expressed with 8 decimals
    uint256 internal constant ORACLE_PRICE_DECIMALS = 8;
    /// @dev The otoken (ERC20) that tracks option ownership uses 8 decimals for token quantities
    uint256 internal constant OTOKEN_QTY_DECIMALS = 8;
&nbsp;
    /// @dev Seconds per day required for calculating option duration in days
    uint256 internal constant SECONDS_IN_A_DAY = 86400;
&nbsp;
    /// @dev Max int size for max tvl validation
    uint256 internal constant MAX_INT = 2**256 - 1;
&nbsp;
    /**
     * @notice Initialize this implementation contract
     * @dev Function initializer for the upgradeable proxy.
     * @param _opynAddressBook The address of the OpynAddressBook contract.
     * @param _poolCollateralToken The address of the collateral used in this contract.
     * @param _curveManager The address of the CurveManager contract.
     * @param _criteriaManager The address of the CriteriaManager contract.
     */
    function initialize(
        address _opynAddressBook,
        address _poolCollateralToken,
        address _curveManager,
        address _criteriaManager
    ) external initializer {
        __Ownable_init();
        __Pausable_init_unchained();
        sumOfAllUnlockedBalances = 0;
        sumOfAllLockedBalances = 0;
        maxTotalValueLocked = MAX_INT;
        // We interact with multiple Opyn contracts, but each time we do so we go through the
        // Opyn addressbook contrac to identify the address we want to interact with. This means we are
        // robust to the opyn system being upgraded, provided the addressbook remains constant.
        opynAddressBook = AddressBookInterface(_opynAddressBook);
&nbsp;
        // One exception: Opyn's addressbook deploys an upgradable proxy in front of its Controller contract, and upgades
        // that proxy to change the controller. As such we save the proxy address here, and avoid the need
        // to go through the addressbook to get to the controller. This saves some gas.
        opynController = ControllerInterface(opynAddressBook.getController());
        vaultCount = opynController.getAccountVaultCounter(address(this));
        poolCollateralToken = IERC20(_poolCollateralToken);
        crv = ICurveManager(_curveManager);
        crit = ICriteriaManager(_criteriaManager);
    }
&nbsp;
    ///////////////////////////////////////////////////////////////////////////
    //  Events
    ///////////////////////////////////////////////////////////////////////////
&nbsp;
    /// @notice Emits when an LP deposits (initially unlocked) funds into Potion.
    event Deposited(address indexed lp, uint256 indexed poolId, uint256 amount);
&nbsp;
    /// @notice Emits when an LP withdraws unlocked funds from Potion.
    event Withdrawn(address indexed lp, uint256 indexed poolId, uint256 amount);
&nbsp;
    /// @notice Emits when an LP associates a set of crtieria with a pool of their capital.
    event CriteriaSetSelected(address indexed lp, uint256 indexed poolId, bytes32 criteriaSetHash);
&nbsp;
    /// @notice Emits when an LP associates a pricing curve with a pool of their capital.
    event CurveSelected(address indexed lp, uint256 indexed poolId, bytes32 curveHash);
&nbsp;
    /// @notice Emits once per purchase, with details of the buyer and the aggregate figures involved.
    event OptionsBought(
        address indexed buyer,
        address indexed otoken,
        uint256 numberOfOtokens,
        uint256 totalPremiumPaid
    );
&nbsp;
    /// @notice Emits for every LP involved in collateralizing a purchase, with details of the LP and the figures involved in their part of the purchase.
    event OptionsSold(
        address indexed lp,
        uint256 indexed poolId,
        address indexed otoken,
        bytes32 curveHash,
        uint256 numberOfOtokens,
        uint256 liquidityCollateralized,
        uint256 premiumReceived
    );
&nbsp;
    /// @notice Emits when all collateral for a given otoken (which must have reached expiry) is reclaimed from the Opyn contracts, into this Potion contract.
    event OptionSettled(address indexed otoken, uint256 collateralReturned);
&nbsp;
    /// @notice Emits every time that some collateral (preciously reclaimed from the Opyn conracts into this Potion contract) is redistributed to one of the collateralising LPs.
    event OptionSettlementDistributed(
        address indexed otoken,
        address indexed lp,
        uint256 indexed poolId,
        uint256 collateralReturned
    );
&nbsp;
    ///////////////////////////////////////////////////////////////////////////
    //  Structs and vars
    ///////////////////////////////////////////////////////////////////////////
&nbsp;
    /// @dev A VaultInfo contains the data about a single Opyn Vault.
    struct VaultInfo {
        uint256 vaultId; // the vault's ID in Opyn's contracts. Valid vaultIDs start at 1, so this can be used as an existence check in a map
        uint256 totalContributions; // The total contributed to the vault by Potion LPs, denominated in collateral tokens
        bool settled; // Whether the vault has been settled. That is, whether the unused collateral has, after otoken expiry, been reclaimed from the Opyn contracts into this contract
        uint256 settledAmount; // The amount of unused collateral that was reclaimed from the Opyn contracts upon settlement
        mapping(address =&gt; mapping(uint256 =&gt; uint256)) contributionsByLp; // The vault contributions, denominated in collateral tokens, indexed by LP and then by the LP's poolId
    }
&nbsp;
    /// @dev The keys required to identify a given pool of capital in the lpPools map.
    struct PoolIdentifier {
        address lp;
        uint256 poolId;
    }
&nbsp;
    /// @dev The data associated with a given pool of capital, belonging to one LP
    struct PoolOfCapital {
        uint256 total; // The total (locked or unlocked) of capital in the pool, denominated in collateral tokens
        uint256 locked; // The locked capital in the pool, denominated in collateral tokens
        bytes32 curveHash; // Identifies the curve to use when pricing the premiums charged for any otokens sold (&amp; collateralizated) by this pool
        bytes32 criteriaSetHash; // Identifies the set of otokens that this pool is willing to sell (&amp; collateralize)
    }
&nbsp;
    /// @dev The counterparty data associated with a given (tranche of an) otoken purchase. For gas efficiency reasons, the buyer must pass in details of the curve and criteria, and these are verified as a match (rather than calculated) on-chain
    struct CounterpartyDetails {
        address lp; // The LP to buy from
        uint256 poolId; // The pool (belonging to LP) that will colalteralize the otoken
        ICurveManager.Curve curve; // The curve used to calculate the otoken premium
        ICriteriaManager.Criteria criteria; // The criteria associated with this curve, which matches the otoken
        uint256 orderSizeInOtokens; // The number of otokens to buy from this particular counterparty
    }
&nbsp;
    /// @dev Used only internally, in memory, to track aggregate values across an order involving multiple LPs. This reduces the number of local variables and thereby avoids a "stack too deep" error at compile time.
    struct AggregateOrderData {
        uint256 premium;
        uint256 collateral;
        uint256 orderSize;
    }
&nbsp;
    /// @dev Used only internally, in memory, to track parameters involved in calculating collateral requirements. This reduces the number of local variables and thereby avoids a "stack too deep" error at compile time.
    struct CollateralCalculationParams {
        bool collateralMatchesStrike; // true iff the collateral asset and the strike asset are the same (this simplifies the calculation)
        FPI.FixedPointInt strikePrice; // The strike asset price returned by the oracle, in the FixedPointInt representation of decimal numbers
        FPI.FixedPointInt collateralPrice; // The collateral asset price returned by the oracle, in the FixedPointInt representation of decimal numbers
        FPI.FixedPointInt otokenStrikeHumanReadable; // The strike price denominated in strike tokens, in human readable notation (e.g. if strike = 300USDC, this is "300.0" not "300000000"
        uint256 collateralTokenDecimals; // The number of decimals used by the collateral token (may differ from the strike token)
    }
&nbsp;
    ///////////////////////////////////////////////////////////////////////////
    //  Contract state
    ///////////////////////////////////////////////////////////////////////////
&nbsp;
    /// @dev The maximum value (denominated in collateral tokens) that can be custodied by this contract, or by Opyn on behalf of this contract
    // (i.e. including locked and unlocked balances across all pools of capital).
    uint256 public maxTotalValueLocked;
&nbsp;
    /// @dev The number of Opyn vaults that this contract has ever opened
    uint256 public vaultCount;
&nbsp;
    /// @dev One Potion vault per token, indexed by otoken address. We know that this map only contains entries for whitelisted (or previously whitelisted) otokens, because we check before creating entries.
    mapping(address =&gt; VaultInfo) internal vaults;
&nbsp;
    /// @dev Data about pools of capital, indexed first by LP address and then by an (arbitrary) numeric poolId
    mapping(address =&gt; mapping(uint256 =&gt; PoolOfCapital)) public lpPools;
&nbsp;
    /// @dev The aggregate amount of capital currently unlocked in this contract by LPs. Denominated in collateral tokens. This is used for some safety checks, and could theoretically be removed at a later date to reduce gas costs.
    uint256 public sumOfAllUnlockedBalances;
&nbsp;
    /// @dev The aggregate amount of capital currently deposited locked in this contract by LPs. Denominated in collateral tokens. This is used for some safety checks, and could theoretically be removed at a later date to reduce gas costs.
    uint256 public sumOfAllLockedBalances;
&nbsp;
    // All Opyn contracts are trusted =&gt; we assume there is no malicious code within Opyn contracts.
    /// @dev If we want to interact with the Opyn Controller, we already know the address of its transparent proxy. This contract is trusted.
    ControllerInterface public opynController;
    /// @dev If we want to interact with any other Opyn contract, we look up its address in the addressbook. All Opyn contracts are trusted.
    AddressBookInterface public opynAddressBook;
&nbsp;
    /// @dev The curve manager is used to manage curves, and curve hashes, and the calculation of prices based on curves.
    ICurveManager public crv;
&nbsp;
    /// @dev The criteria manager is used to manage criteria, and sets of criteria, and hashes thereof
    ICriteriaManager public crit;
&nbsp;
    /// @dev Currently we support only a single token as collateral. The easiest route to supporting multiple types of collateral may be multiple instances of the PotionLiquidityPool contract. The collateral token is chosen carefully and is therefore probably to be trusted, but we nevertheless attempt to interact with it at the _end_ of each transaction to reduce the scope for re-entrancy attacks!
    IERC20 public poolCollateralToken;
&nbsp;
    ///////////////////////////////////////////////////////////////////////////
    //  Admin (owner) functions
    ///////////////////////////////////////////////////////////////////////////
&nbsp;
    /**
     * @notice Set the total max value locked per user in a Pool of Capital.
     * @param _newMax The new total max value locked.
     */
    function setMaxTotalValueLocked(uint256 _newMax) external onlyOwner whenNotPaused {
        maxTotalValueLocked = _newMax;
    }
&nbsp;
    /**
     * @notice Allows the admin to pause the whole system
     */
    function pause() external onlyOwner whenNotPaused {
        _pause();
    }
&nbsp;
    /**
     * @notice Allows the admin to unpause the whole system
     */
    function unpause() external onlyOwner whenPaused {
        _unpause();
    }
&nbsp;
    /**
     * @notice Update the contract used to manage curves, and curve hashes, and the calculation of prices based on curves
     * @dev To ensure continued operation for all users, any new CurveManager must be pre-populated with the same data as the existing CurveManager (for reasons of gas efficiency, we do not use an upgradable proxy mechanism)
     * @dev The `CurveManager` can be changed while paused, in case this is required to address security issues
     * @param _new The new address of the CurveManager
     */
    function setCurveManager(ICurveManager _new) external onlyOwner {
        crv = _new;
    }
&nbsp;
    /**
     * @notice Update the contract used to manage criteria, and sets of criteria, and hashes thereof
     * @dev Note To ensure continued operation for all users, any new CriteriaManager must be pre-populated with the same data as the existing CriteriaManager (for reasons of gas efficiency, we do not use an upgradable proxy mechanism)
     * @dev The `CriteriaManager` can be changed while paused, in case this is required to address security issues
     * @param _new The new address of the CriteriaManager
     */
    function setCriteriaManager(ICriteriaManager _new) external onlyOwner {
        crit = _new;
    }
&nbsp;
    ///////////////////////////////////////////////////////////////////////////
    //  Getters &amp; view functions
    ///////////////////////////////////////////////////////////////////////////
&nbsp;
    /**
     * @notice Get the ID of the existing Opyn vault that Potion uses to collateralize a given OToken.
     * @param _otoken The identifier (token contract address) of the OToken. Not checked for validity in this view function.
     * @return The unique ID of the vault, &gt; 0. If no vault exists, the returned value will be 0
     */
    function getVaultId(OtokenInterface _otoken) public view returns (uint256) {
        return vaults[address(_otoken)].vaultId;
    }
&nbsp;
    /**
     * @notice Query the locked capital in a specified pool of capital
     * @dev _poolId is generated in the client side.
     * @param _lp The address of the liquidity provider.
     * @param _poolId An (LP-specific) pool identifier.
     * @return The amount of capital locked in the pool, denominated in collateral tokens.
     */
    function lpLockedAmount(address _lp, uint256 _poolId) external view returns (uint256) {
        return lpPools[_lp][_poolId].locked;
    }
&nbsp;
    /**
     * @notice Query the total capital (locked + unlocked) in a specified pool of capital.
     * @param _lp The address of the liquidity provider.
     * @param _poolId An (LP-specific) pool identifier.
     * @return The amount of capital in the pool, denominated in collateral tokens.
     */
    function lpTotalAmount(address _lp, uint256 _poolId) external view returns (uint256) {
        return lpPools[_lp][_poolId].total;
    }
&nbsp;
    /**
     * @notice The amount of capital required to collateralize a given quantitiy of a given OToken.
     * @param _otoken The identifier (token contract address) of the OToken to be collateralized. Not checked for validity in this view function.
     * @param _otokenQty The number of OTokens we wish to collateralize.
     * @return The amount of collateral required, denominated in collateral tokens.
     */
    function collateralNeededForPuts(OtokenInterface _otoken, uint256 _otokenQty) external view returns (uint256) {
        CollateralCalculationParams memory collateralCalcParams;
        (address collateralAsset, , address strikeAsset, uint256 strikePrice, , ) = _otoken.getOtokenDetails();
        (
            collateralCalcParams.collateralMatchesStrike,
            collateralCalcParams.strikePrice,
            collateralCalcParams.collateralPrice
        ) = _getLivePrices(strikeAsset, collateralAsset);
        collateralCalcParams.otokenStrikeHumanReadable = FPI.fromScaledUint(strikePrice, OTOKEN_QTY_DECIMALS);
        collateralCalcParams.collateralTokenDecimals = ERC20Interface(collateralAsset).decimals();
        return _collateralNeededForPuts(_otokenQty, collateralCalcParams);
    }
&nbsp;
    /**
     * @notice Calculate the premiums for a particular OToken from the provided sellers.
     * @param _otoken The `OToken` for which we calculate the premium charged for a purchase. This is not checked for validity in this view function, nor is it checked for compatibility with sellers.
     * @param _sellers The details of the counterparties and counterparty pricing, for which we calculate the premiums. These are assumed (not checked) to be compatibile with the `Otoken`.
     * @return totalPremiumInCollateralTokens The total premium in collateral tokens.
     * @return perLpPremiumsInCollateralTokens The premiums per LP in collateral tokens, ordered in the same way as the `_sellers` param.
     */
    function premiums(OtokenInterface _otoken, CounterpartyDetails[] memory _sellers)
        external
        view
        returns (uint256 totalPremiumInCollateralTokens, uint256[] memory perLpPremiumsInCollateralTokens)
    {
        perLpPremiumsInCollateralTokens = new uint256[](_sellers.length);
&nbsp;
        (address collateralAsset, , address strikeAsset, uint256 strikePrice, , ) = _otoken.getOtokenDetails();
        CollateralCalculationParams memory collateralCalcParams;
        (
            collateralCalcParams.collateralMatchesStrike,
            collateralCalcParams.strikePrice,
            collateralCalcParams.collateralPrice
        ) = _getLivePrices(strikeAsset, collateralAsset);
        collateralCalcParams.otokenStrikeHumanReadable = FPI.fromScaledUint(strikePrice, OTOKEN_QTY_DECIMALS);
        collateralCalcParams.collateralTokenDecimals = ERC20Interface(collateralAsset).decimals();
&nbsp;
        // This loop is unbounded. If it runs outof gas that's because the buyer is trying to buy from too many different pools
        // It is the responsibility of the router to not route buyers to too many pools in a singel transaction
        for (uint256 i = 0; i &lt; _sellers.length; i++) {
            CounterpartyDetails memory seller = _sellers[i];
            uint256 collateralRequired = _collateralNeededForPuts(seller.orderSizeInOtokens, collateralCalcParams);
            uint256 premium = _premiumForLp(seller.lp, seller.poolId, seller.curve, collateralRequired);
            perLpPremiumsInCollateralTokens[i] = premium;
            totalPremiumInCollateralTokens = totalPremiumInCollateralTokens + premium;
        }
        return (totalPremiumInCollateralTokens, perLpPremiumsInCollateralTokens);
    }
&nbsp;
    /**
     * @notice Calculates the utilization before and after locking new collateral amount.
     * @param _lp The address of the liquidity provider.
     * @param _poolId An (LP-specific) pool identifier.
     * @param _collateralToLock The amount of collateral to lock.
     * @return utilBeforeAs59x18 Utilization before locking the collateral specified.
     * @return utilAfterAs59x18 Utilization after locking the collateral specified.
     * @return lockedAmountBefore The total collateral locked before locking the collateral specified.
     * @return lockedAmountAfter The total collateral locked after locking the collateral specified.
     */
    function util(
        address _lp,
        uint256 _poolId,
        uint256 _collateralToLock
    )
        public
        view
        returns (
            int256 utilBeforeAs59x18,
            int256 utilAfterAs59x18,
            uint256 lockedAmountBefore,
            uint256 lockedAmountAfter
        )
    {
        PoolOfCapital storage bal = lpPools[_lp][_poolId];
        lockedAmountBefore = bal.locked;
        lockedAmountAfter = bal.locked + _collateralToLock;
        require(lockedAmountAfter &lt;= bal.total, "util calc: &gt;100% locked");
        <span class="missing-if-branch" title="else path not taken" >E</span>require(bal.total &gt; 0, "util calc: 0 balance");
&nbsp;
        // Note that the use of fromUint here implies a max total balance in any pool of ~5.8e+58 wei.
        // This is 5.8e+40 human units if the collateral token uses 18 decimals
        utilBeforeAs59x18 = PRBMathSD59x18.fromUint(lockedAmountBefore).div(PRBMathSD59x18.fromUint(bal.total));
        utilAfterAs59x18 = PRBMathSD59x18.fromUint(lockedAmountAfter).div(PRBMathSD59x18.fromUint(bal.total));
&nbsp;
        return (utilBeforeAs59x18, utilAfterAs59x18, lockedAmountBefore, lockedAmountAfter);
    }
&nbsp;
    /**
     * @notice The specified OToken's strike price as a percentage of the current market spot price.
     * @dev In-The-Money put options will return a value &gt; 100; Out-Of-The-Money put options will return a value &lt;= 100.
     * @param _otoken The identifier (token contract address) of the OToken to get the strike price. Not checked for validity in this view function.
     * @return The strike price as a percentage of the current price, rounded up to an integer percentage.
     *         E.g. if current price is $100, then a strike price of $94.01 returns a strikePercent of 95,
     *         and a strike price of $102.99 returns a strikePercent of 103.
     */
    function percentStrike(OtokenInterface _otoken) public view returns (uint256) {
        // strikePrice() returns a value that assumes 8 digits (i.e. human readable value * 10^8), regardless of the decimals used by any other token
        (, address underlyingAsset, address strikeAsset, uint256 strikePrice, , ) = _otoken.getOtokenDetails();
        uint256 strikePriceInStrikeTokensTimes10e8 = strikePrice;
&nbsp;
        // Get the spot prices of the underlying and strike assets
        (, FPI.FixedPointInt memory underlyingPrice, FPI.FixedPointInt memory strikeTokenPrice) = _getLivePrices(
            underlyingAsset,
            strikeAsset
        );
        assert(underlyingPrice.value &gt; 0);
        assert(strikeTokenPrice.value &gt; 0);
        FPI.FixedPointInt memory spotPriceInStrikeTokensAsDecimal = underlyingPrice.div(strikeTokenPrice);
        uint256 spotPriceInStrikeTokensTimes10e8 = spotPriceInStrikeTokensAsDecimal.toScaledUint(
            ORACLE_PRICE_DECIMALS,
            false
        );
&nbsp;
        // To get the strike as a percentage of the spot price, we want to use the same units for both the
        // numerator and the denominator when calculating:
        //    (strikeTokenPrice * 100) / spotPrice
        //
        // Here we add (denominator -1) to the numerator before dividing, to ensure that we round up
        return
            ((strikePriceInStrikeTokensTimes10e8 * 100) + spotPriceInStrikeTokensTimes10e8 - 1) /
            spotPriceInStrikeTokensTimes10e8;
    }
&nbsp;
    /**
     * @notice It calculates the number of days (including all partial days) until the specified Otoken expires.
     * @dev reverts if the otoken already expired
     * @param _otoken The identifier (address) of the Otoken. Not checked for validity in this view function.
     * @return The number of days remaining until OToken expiry, rounded up if necessary to make to an integer number of days.
     */
    function durationInDays(OtokenInterface _otoken) public view returns (uint256) {
        uint256 expiry = _otoken.expiryTimestamp();
        <span class="missing-if-branch" title="else path not taken" >E</span>require(expiry &gt; block.timestamp, "Otoken has expired");
        uint256 duration = expiry - block.timestamp;
        // To round up the answer, we add SECONDS_IN_A_DAY-1 before we divide
        return (duration + SECONDS_IN_A_DAY - 1) / SECONDS_IN_A_DAY;
    }
&nbsp;
    ///////////////////////////////////////////////////////////////////////////
    //  Public interface
    ///////////////////////////////////////////////////////////////////////////
&nbsp;
    /**
     * @notice Create an Opyn vault, which Potion will use to collateralize a given OToken.
     * @dev `_otoken` is implicitly checked for validity when we call `_getOrCreateVaultInfo`.
     * @param _otoken The identifier (token contract address) of the OToken.
     * @return The unique ID of the vault, &gt; 0.
     */
    function createNewVaultId(OtokenInterface _otoken) external whenNotPaused returns (uint256) {
        <span class="missing-if-branch" title="else path not taken" >E</span>require(getVaultId(_otoken) == 0, "Vault already exists");
        return _getOrCreateVaultInfo(_otoken).vaultId;
    }
&nbsp;
    /**
     * @notice Deposit collateral tokens from the sender into the specified pool belonging to the caller.
     * @param _poolId The identifier for a PoolOfCapital belonging to the caller. Could be an existing pool or a new one.
     * @param _amount The amount of collateral tokens to deposit.
     */
    function deposit(uint256 _poolId, uint256 _amount) public whenNotPaused {
        <span class="missing-if-branch" title="else path not taken" >E</span>if (_amount &gt; 0) {
            _credit(msg.sender, _poolId, _amount);
            poolCollateralToken.safeTransferFrom(msg.sender, address(this), _amount);
            assert(poolCollateralToken.balanceOf(address(this)) &gt;= sumOfAllUnlockedBalances);
            emit Deposited(msg.sender, _poolId, _amount);
        }
    }
&nbsp;
    /**
     * @notice Deposit collateral tokens from the sender into the specified pool belonging to the caller and configures the Curve and CriteriaSet.
     * @param _poolId The identifier for a PoolOfCapital belonging to the caller. Could be an existing pool or a new one.
     * @param _amount The amount of collateral tokens to deposit.
     * @param _curveHash The hash of the new Curve to be set in the specified pool.
     * @param _criteriaSetHash The hash of the new CriteriaSet to be set in the specified pool.
     */
    function depositAndConfigurePool(
        uint256 _poolId,
        uint256 _amount,
        bytes32 _curveHash,
        bytes32 _criteriaSetHash
    ) external whenNotPaused {
        setCurve(_poolId, _curveHash);
        setCurveCriteria(_poolId, _criteriaSetHash);
&nbsp;
        // We deposit last as this involves an external call, albeit to a trusted collateral token
        deposit(_poolId, _amount);
    }
&nbsp;
    /**
     * @notice Set the "set of criteria" associated with a given pool of capital. These criteria will be used to determine which otokens this pool of capital is prepared to collateralize. If any Criteria in the set is a match, then the otoken can potentially be colalteralized by this pool of capital, subject to the premium being paid and sufficient liquidity being available.
     * @param _poolId The identifier for a PoolOfCapital belonging to the caller. Could be an existing pool or a new one.
     * @param _criteriaSetHash The hash of the immutable CriteriaSet to be associated with this PoolOfCapital.
     */
    function setCurveCriteria(uint256 _poolId, bytes32 _criteriaSetHash) public whenNotPaused {
        // Allow setting criteriaSet = 0x000... to indicate that this capital is not available for use
        require(_criteriaSetHash == bytes32(0) || crit.isCriteriaSetHash(_criteriaSetHash), "No such criteriaSet");
        if (lpPools[msg.sender][_poolId].criteriaSetHash != _criteriaSetHash) {
            lpPools[msg.sender][_poolId].criteriaSetHash = _criteriaSetHash;
            emit CriteriaSetSelected(msg.sender, _poolId, _criteriaSetHash);
        }
    }
&nbsp;
    /**
     * @notice Set the curve associated with a given pool of capital. The curve will be used to price the premiums charged for any otokens that this pool of capital is prepared to collateralize.
     * @param _poolId The identifier for a PoolOfCapital belonging to the caller. Could be an existing pool or a new one.
     * @param _curveHash The hash of the immutable Curve to be associated with this PoolOfCapital.
     */
    function setCurve(uint256 _poolId, bytes32 _curveHash) public whenNotPaused {
        require(crv.isKnownCurveHash(_curveHash), "No such curve");
        if (lpPools[msg.sender][_poolId].curveHash != _curveHash) {
            lpPools[msg.sender][_poolId].curveHash = _curveHash;
            emit CurveSelected(msg.sender, _poolId, _curveHash);
        }
    }
&nbsp;
    /**
     * @notice Withdraw unlocked collateral tokens from the specified pool belonging to the caller, and send them to the caller's address.
     * @param _poolId The identifier for a PoolOfCapital belonging to the caller. Could be an existing pool or a new one.
     * @param _amount The amount of collateral tokens to withdraw.
     */
    function withdraw(uint256 _poolId, uint256 _amount) external whenNotPaused {
        <span class="missing-if-branch" title="else path not taken" >E</span>if (_amount &gt; 0) {
            _debit(msg.sender, _poolId, _amount);
            poolCollateralToken.safeTransfer(msg.sender, _amount);
            assert(poolCollateralToken.balanceOf(address(this)) &gt;= sumOfAllUnlockedBalances);
            emit Withdrawn(msg.sender, _poolId, _amount);
        }
    }
&nbsp;
    /**
     * @notice Creates a new otoken, and then buy it from the specified list of sellers.
     * @param _underlyingAsset A property of the otoken that is to be created.
     * @param _strikeAsset A property of the otoken that is to be created.
     * @param _collateralAsset A property of the otoken that is to be created.
     * @param _strikePrice A property of the otoken that is to be created.
     * @param _expiry A property of the otoken that is to be created.
     * @param _isPut A property of the otoken that is to be created.
     * @param _sellers The LPs to buy the new otokens from. These LPs will charge a premium to collateralize the otoken.
     * @param _maxPremium The maximum premium that the buyer is willing to pay, denominated in collateral tokens (wei) and aggregated across all sellers
     * @return premium The total premium paid.
     */
    function createAndBuyOtokens(
        address _underlyingAsset,
        address _strikeAsset,
        address _collateralAsset,
        uint256 _strikePrice,
        uint256 _expiry,
        bool _isPut,
        CounterpartyDetails[] memory _sellers,
        uint256 _maxPremium
    ) external whenNotPaused returns (uint256 premium) {
        <span class="missing-if-branch" title="else path not taken" >E</span>require(_collateralAsset == address(poolCollateralToken), "Potion: wrong collateral token");
        OtokenFactoryInterface otokenFactory = OtokenFactoryInterface(opynAddressBook.getOtokenFactory());
        address otoken = otokenFactory.createOtoken(
            _underlyingAsset,
            _strikeAsset,
            _collateralAsset,
            _strikePrice,
            _expiry,
            _isPut
        );
        return buyOtokens(OtokenInterface(otoken), _sellers, _maxPremium);
    }
&nbsp;
    /**
     * @notice Buy a OTokens from the specified list of sellers.
     * @dev `_otoken` is implicitly checked for validity when we call `_getOrCreateVaultInfo`.
     * @param _otoken The identifier (address) of the OTokens being bought.
     * @param _sellers The LPs to buy the new OTokens from. These LPs will charge a premium to collateralize the otoken.
     * @param _maxPremium The maximum premium that the buyer is willing to pay, denominated in collateral tokens (wei) and aggregated across all sellers
     * @return premium The aggregated premium paid.
     */
    function buyOtokens(
        OtokenInterface _otoken,
        CounterpartyDetails[] memory _sellers,
        uint256 _maxPremium
    ) public whenNotPaused returns (uint256 premium) {
        AggregateOrderData memory runningTotals;
        VaultInfo storage vault = _getOrCreateVaultInfo(_otoken);
&nbsp;
        // We have some info about the otoken that we read for every seller. Get it once and cache it.
        ICriteriaManager.OtokenProperties memory otokenCache;
        address collateralAsset;
        uint256 otokenStrikePrice;
        (
            collateralAsset,
            otokenCache.underlyingAsset,
            otokenCache.strikeAsset,
            otokenStrikePrice,
            ,
            otokenCache.isPut
        ) = _otoken.getOtokenDetails();
        IERC20 collateralToken = IERC20(collateralAsset);
&nbsp;
        // For now, only puts are supported and only with one collateral token
        <span class="missing-if-branch" title="else path not taken" >E</span>require(collateralToken == poolCollateralToken, "Potion: wrong collateral token");
        <span class="missing-if-branch" title="else path not taken" >E</span>require(otokenCache.isPut, "Potion: otoken not a put");
&nbsp;
        // Getting the durationInDays implicitly asserts that the otoken has not yet expired
        otokenCache.percentStrikeValue = percentStrike(_otoken);
        otokenCache.wholeDaysRemaining = durationInDays(_otoken);
&nbsp;
        // We need the price ratio, strike price, and the decimals used by the collateral token, but we
        // can get these once rather than once-per-seller
        CollateralCalculationParams memory collateralCalcParams;
        (
            collateralCalcParams.collateralMatchesStrike,
            collateralCalcParams.strikePrice,
            collateralCalcParams.collateralPrice
        ) = _getLivePrices(otokenCache.strikeAsset, collateralAsset);
        collateralCalcParams.otokenStrikeHumanReadable = FPI.fromScaledUint(otokenStrikePrice, OTOKEN_QTY_DECIMALS);
        collateralCalcParams.collateralTokenDecimals = ERC20Interface(collateralAsset).decimals();
&nbsp;
        // Iterate through sellers, doing checks and optimistically updating with assumption that transaction will succeed
        // This loop is unbounded. If it runs outof gas that's because the buyer is trying to buy from too many different pools
        // It is the responsibility of the router to not route buyers to too many pools in a singel transaction
        <span class="missing-if-branch" title="else path not taken" >E</span>require(_sellers.length &gt; 0, "Can't buy from no sellers");
&nbsp;
        for (uint256 i = 0; i &lt; _sellers.length; i++) {
            CounterpartyDetails memory seller = _sellers[i];
            bytes32 curveHash = crv.hashCurve(seller.curve);
            require(seller.orderSizeInOtokens &gt; 0, "Order tranche is zero");
            <span class="missing-if-branch" title="else path not taken" >E</span>require(crv.isKnownCurveHash(curveHash), "No such curve");
            require(curveHash == lpPools[seller.lp][seller.poolId].curveHash, "Invalid curve");
            <span class="missing-if-branch" title="else path not taken" >E</span>require(
                crit.isInCriteriaSet(
                    lpPools[seller.lp][seller.poolId].criteriaSetHash,
                    crit.hashCriteria(seller.criteria)
                ),
                "Invalid criteria hash"
            );
&nbsp;
            // Check that the token matches the LP's criteria
            <span class="missing-if-branch" title="else path not taken" >E</span>require(seller.criteria.underlyingAsset == otokenCache.underlyingAsset, "wrong underlying token");
            <span class="missing-if-branch" title="else path not taken" >E</span>require(seller.criteria.strikeAsset == otokenCache.strikeAsset, "wrong strike token");
            <span class="missing-if-branch" title="else path not taken" >E</span>require(seller.criteria.isPut == otokenCache.isPut, "call options not supported");
            <span class="missing-if-branch" title="else path not taken" >E</span>require(seller.criteria.maxStrikePercent &gt;= otokenCache.percentStrikeValue, "invalid strike%");
            <span class="missing-if-branch" title="else path not taken" >E</span>require(seller.criteria.maxDurationInDays &gt;= otokenCache.wholeDaysRemaining, "invalid duration");
&nbsp;
            (uint256 latestPremium, uint256 latestCollateral) = _initiatePurchaseAndUpdateFundsForOneLP(
                seller,
                collateralCalcParams
            );
            runningTotals.premium = runningTotals.premium + latestPremium;
            runningTotals.orderSize = runningTotals.orderSize + seller.orderSizeInOtokens;
            runningTotals.collateral = runningTotals.collateral + latestCollateral;
            vault.contributionsByLp[seller.lp][seller.poolId] =
                vault.contributionsByLp[seller.lp][seller.poolId] +
                latestCollateral;
            emit OptionsSold(
                seller.lp,
                seller.poolId,
                address(_otoken),
                curveHash,
                seller.orderSizeInOtokens,
                latestCollateral,
                latestPremium
            );
        }
&nbsp;
        require(runningTotals.premium &lt;= _maxPremium, "Premium higher than max");
        collateralToken.safeIncreaseAllowance(opynAddressBook.getMarginPool(), runningTotals.collateral);
&nbsp;
        // Calling into Opyn implicitly checks that the otoken is valid (e.g. not a dummy token, and not expired)
        vault.totalContributions = vault.totalContributions + runningTotals.collateral;
        Actions.ActionArgs[] memory opynActions = ActionsLib._actionArgsToDepositCollateralAndMintOtokens(
            vault.vaultId,
            _otoken,
            address(collateralToken),
            runningTotals.collateral,
            runningTotals.orderSize
        );
        opynController.operate(opynActions);
&nbsp;
        // Transfer colateral at the end, just in case collateral token is malicious (but if it is we are probably screwed for other reasons!)
        collateralToken.safeTransferFrom(msg.sender, address(this), runningTotals.premium);
        assert(poolCollateralToken.balanceOf(address(this)) &gt;= sumOfAllUnlockedBalances);
        emit OptionsBought(msg.sender, address(_otoken), runningTotals.orderSize, runningTotals.premium);
        return runningTotals.premium;
    }
&nbsp;
    /**
     * @notice Retrieve unused collateral from Opyn into this contract. Does not redistribute it to our (unbounded number of) LPs
     * @dev `_otoken` is implicitly checked for validity when we call `_getVaultInfo`.
     * Redistribution can be done by calling redistributeSettlement(addresses).
     * @param _otoken The identifier (address) of the expired OToken for which unused collateral should be retrieved.
     */
    function settleAfterExpiry(OtokenInterface _otoken) public whenNotPaused {
        VaultInfo storage v = _getVaultInfo(_otoken);
        <span class="missing-if-branch" title="else path not taken" >E</span>require(!v.settled, "Vault already settled");
&nbsp;
        // Success or revert
        v.settled = true;
&nbsp;
        <span class="missing-if-branch" title="else path not taken" >E</span>require(opynController.isSettlementAllowed(address(_otoken)), "Otoken cannot (yet) settle");
&nbsp;
        // Get the settled amount of collateral
        v.settledAmount = opynController.getProceed(address(this), v.vaultId);
&nbsp;
        <span class="missing-if-branch" title="else path not taken" >E</span>if (v.settledAmount &gt; 0) {
            Actions.ActionArgs[] memory openVaultActions = new Actions.ActionArgs[](1);
            openVaultActions[0] = ActionsLib._getSettleVaultAction(address(this), v.vaultId, address(this));
            opynController.operate(openVaultActions);
&nbsp;
            emit OptionSettled(address(_otoken), v.settledAmount);
        }
    }
&nbsp;
    /**
     * @notice Calculates the outstading settlement from the PoolIdentifier in OTokens.
     * @dev Redistribution can be done by calling redistributeSettlement(addresses).
     * @dev `_otoken` is implicitly checked for validity when we call `_getVaultInfo`.
     * @param _otoken The identifier (address) of the expired OToken for which unused collateral should be retrieved.
     * @param _pool The pool information which the outstanding settlement is calculated.
     * @return collateralDueBack The amount of collateral that can be removed from a vault.
     */
    function outstandingSettlement(OtokenInterface _otoken, PoolIdentifier calldata _pool)
        public
        view
        returns (uint256 collateralDueBack)
    {
        VaultInfo storage v = _getVaultInfo(_otoken);
        uint256 contribution = v.contributionsByLp[_pool.lp][_pool.poolId];
        <span class="missing-if-branch" title="if path not taken" >I</span>if (v.totalContributions == 0 || contribution == 0) {
<span class="cstat-no" title="statement not covered" >            return 0;</span>
        }
&nbsp;
        if (isSettled(_otoken)) {
            return (v.settledAmount * contribution) / v.totalContributions;
        } else {
            uint256 settledAmount = opynController.getProceed(address(this), v.vaultId);
            // Round down, so that we never over-pay
            return (settledAmount * contribution) / v.totalContributions;
        }
    }
&nbsp;
    /**
     * @notice Check whether a give OToken has been settled.
     * @dev Settled OTokens may not have had funds redistributed to all (or any) contributing LPs.
     * @dev `_otoken` is implicitly checked for validity when we call `_getVaultInfo`.
     * @param _otoken the (settled or unsettled) OToken.
     * @return True if it is settled, otherwise false
     */
    function isSettled(OtokenInterface _otoken) public view returns (bool) {
        VaultInfo storage v = _getVaultInfo(_otoken);
        return v.settled;
    }
&nbsp;
    /**
     * @notice Redistribute already-retrieved collateral amongst the specified pools. This function must be called after settleAfterExpiry.
     * @dev If the full list of PoolIdentifiers owed funds is too long, a partial list can be provided and additional calls to redistributeSettlement() can be made.
     * @dev `_otoken` is implicitly checked for validity when we call `_getVaultInfo`.
     * @param _otoken The identifier (address) of the settled otoken for which retrieved collateral should be redistributed.
     * @param _pools The pools of capital to which the collateral should be redistributed. These pools must be (a subset of) the pools that provided collateral for the specified otoken.
     */
    function redistributeSettlement(OtokenInterface _otoken, PoolIdentifier[] calldata _pools) public whenNotPaused {
        VaultInfo storage v = _getVaultInfo(_otoken);
        <span class="missing-if-branch" title="else path not taken" >E</span>require(v.settled, "Vault not yet settled");
&nbsp;
        // This loop is unbounded. If it runs out of gas that's because the caller is trying to redistribute
        // funds to too many LPs in one transaction. In that case, the caller can retry with smaller lists
        // (perhaps spreading the long list of LPs across more than one transaction).
        for (uint256 i = 0; i &lt; _pools.length; i++) {
            PoolIdentifier calldata p = _pools[i];
            <span class="missing-if-branch" title="if path not taken" >I</span>if (v.contributionsByLp[p.lp][p.poolId] == 0) {
                continue;
            }
&nbsp;
            // Round down, so that we never over-pay
            uint256 amountToCredit = (v.settledAmount * v.contributionsByLp[p.lp][p.poolId]) / v.totalContributions;
            _burnLocked(p.lp, p.poolId, v.contributionsByLp[p.lp][p.poolId] - amountToCredit);
            _unlock(p.lp, p.poolId, amountToCredit);
            v.contributionsByLp[p.lp][p.poolId] = 0;
            emit OptionSettlementDistributed(address(_otoken), p.lp, p.poolId, amountToCredit);
        }
&nbsp;
        // Check we've not allocated more than we had to give
        assert(poolCollateralToken.balanceOf(address(this)) &gt;= sumOfAllUnlockedBalances);
    }
&nbsp;
    /**
     * @notice Retrieve unused collateral from Opyn, and redistribute it to the specified LPs.
     * @dev If the full list of PoolIdentifiers owed funds is too long, a partial list can be provided and additional calls to redistributeSettlement() can be made.
     * @dev `_otoken` is implicitly checked for validity when we call `settleAfterExpiry`.
     * @param _otoken The identifier (address) of the expired otoken for which unused collateral should be retrieved.
     * @param _pools The pools of capital to which the collateral should be redistributed. These pools must be (a subset of) the pools that provided collateral for the specified otoken.
     */
    function settleAndRedistributeSettlement(OtokenInterface _otoken, PoolIdentifier[] calldata _pools)
        external
        whenNotPaused
    {
        settleAfterExpiry(_otoken);
        redistributeSettlement(_otoken, _pools);
    }
&nbsp;
    /**
     * @notice Deposit and create a curve and criteria set if they don't exist.
     * @dev This function also sets the curve and criteria set in the specified pool.
     * @param _poolId The identifier for a PoolOfCapital belonging to the caller. Could be an existing pool or a new one.
     * @param _amount The amount of collateral tokens to deposit.
     * @param _curve The Curve to add and set in the pool.
     * @param _criterias A sorted array of Criteria, ordered by Criteria hash.
     */
    function depositAndCreateCurveAndCriteria(
        uint256 _poolId,
        uint256 _amount,
        ICurveManager.Curve memory _curve,
        ICriteriaManager.Criteria[] memory _criterias
    ) external whenNotPaused {
        addAndSetCurve(_poolId, _curve);
        addAndSetCriterias(_poolId, _criterias);
&nbsp;
        // We deposit last as this involves an external call, albeit to a trusted collateral token
        deposit(_poolId, _amount);
    }
&nbsp;
    /**
     * @notice Add and set a curve.
     * @dev If the curve already exists, it won't be added
     * @param _poolId The identifier for a PoolOfCapital belonging to the caller. Could be an existing pool or a new one.
     * @param _curve The Curve to add and set in the pool.
     */
    function addAndSetCurve(uint256 _poolId, ICurveManager.Curve memory _curve) public whenNotPaused {
        bytes32 curveHash = crv.addCurve(_curve);
        setCurve(_poolId, curveHash);
    }
&nbsp;
    /**
     * @notice Add criteria, criteria set and set the criteria set in the specified pool.
     * @dev If the criteria and criteria set already exists, it won't be added.
     * @param _poolId The identifier for a PoolOfCapital belonging to the caller. Could be an existing pool or a new one.
     * @param _criterias A sorted array of Criteria, ordered by Criteria hash.
     */
    function addAndSetCriterias(uint256 _poolId, ICriteriaManager.Criteria[] memory _criterias) public whenNotPaused {
        uint256 criteriasLength = _criterias.length;
        bytes32[] memory criteriaHashes = new bytes32[](criteriasLength);
        for (uint256 i = 0; i &lt; criteriasLength; i++) {
            criteriaHashes[i] = crit.addCriteria(_criterias[i]);
        }
        bytes32 criteriaSetHash = crit.addCriteriaSet(criteriaHashes);
        setCurveCriteria(_poolId, criteriaSetHash);
    }
&nbsp;
    ///////////////////////////////////////////////////////////////////////////
    //  Internals
    ///////////////////////////////////////////////////////////////////////////
&nbsp;
    /**
     * @notice Debits unlocked collateral tokens from the specified PoolOfCapital
     * @dev _PoolId is generated on the client side.
     * @param _lp The Address of the Liquidity provider.
     * @param _poolId An (LP-specific) pool identifier..
     * @param _amount The amount to credit to the corresponding PoolOfCapital.
     */
    function _debit(
        address _lp,
        uint256 _poolId,
        uint256 _amount
    ) internal {
        PoolOfCapital storage lpb = lpPools[_lp][_poolId];
        lpb.total = lpb.total - _amount;
        sumOfAllUnlockedBalances = sumOfAllUnlockedBalances - _amount;
        <span class="missing-if-branch" title="else path not taken" >E</span>require(lpb.total &gt;= lpb.locked, "_debit: locked &gt; total");
    }
&nbsp;
    /**
     * @notice Credits unlocked collateral tokens to the specified PoolOfCapital
     * @dev _PoolId is generated on the client side.
     * @param _lp The Address of the Liquidity provider.
     * @param _poolId An (LP-specific) pool identifier..
     * @param _amount The amount to credit to the corresponding PoolOfCapital.
     */
&nbsp;
    function _credit(
        address _lp,
        uint256 _poolId,
        uint256 _amount
    ) internal {
        PoolOfCapital storage lpb = lpPools[_lp][_poolId];
        lpb.total = lpb.total + _amount;
        sumOfAllUnlockedBalances = sumOfAllUnlockedBalances + _amount;
        require(sumOfAllUnlockedBalances + sumOfAllLockedBalances &lt;= maxTotalValueLocked, "Max TVL exceeded");
    }
&nbsp;
    /**
     * @notice Burns collateral tokens from the specified PoolOfCapital
     * @dev _PoolId is generated on the client side.
     * @param _lp The Address of the Liquidity provider.
     * @param _poolId An (LP-specific) pool identifier.
     * @param _amount The amount of collateral tokens to burn from the specified PoolOfCapital.
     */
    function _burnLocked(
        address _lp,
        uint256 _poolId,
        uint256 _amount
    ) internal {
        PoolOfCapital storage lpb = lpPools[_lp][_poolId];
        lpb.total = lpb.total - _amount;
        lpb.locked = lpb.locked - _amount;
        sumOfAllLockedBalances = sumOfAllLockedBalances - _amount;
        // No need to update sumOfAllUnlockedBalances
    }
&nbsp;
    /**
     * @notice Unlocks collateral tokens within the specified PoolOfCapital
     * @dev _PoolId is generated on the client side.
     * @param _lp The Address of the Liquidity provider.
     * @param _poolId An (LP-specific) pool identifier.
     * @param _amount The amount to unlock from the specified PoolOfCapital.
     */
    function _unlock(
        address _lp,
        uint256 _poolId,
        uint256 _amount
    ) internal {
        PoolOfCapital storage lpb = lpPools[_lp][_poolId];
        lpb.locked = lpb.locked - _amount;
        sumOfAllUnlockedBalances = sumOfAllUnlockedBalances + _amount;
        sumOfAllLockedBalances = sumOfAllLockedBalances - _amount;
        <span class="missing-if-branch" title="else path not taken" >E</span>require(lpb.total &gt;= lpb.locked, "_unlock: locked &gt; total");
        assert(poolCollateralToken.balanceOf(address(this)) &gt;= sumOfAllUnlockedBalances);
    }
&nbsp;
    /**
     * @dev Get the VaultInfo for the Opyn vault that Potion uses to collateralize a given otoken
     * @param _otoken The identifier (token contract address) of the otoken. The otoken must have a vault, or the function will throw. Note that only whitelisted (or previously-whitelisted) otokens can have a vault.
     * @return The VaultInfo struct for the now-guaranteed-to-be-valid (i.e. is whitelisted or was previously whitelisted) otoken.
     */
    function _getVaultInfo(OtokenInterface _otoken) internal view returns (VaultInfo storage) {
        <span class="missing-if-branch" title="else path not taken" >E</span>require(vaults[address(_otoken)].vaultId &gt; 0, "No such vault");
        return vaults[address(_otoken)];
    }
&nbsp;
    /**
     * @notice Get the VaultInfo for the Opyn vault that Potion uses to collateralize a given otoken.
     * @dev A vault will be created only if the otoken is whitelisted and a vault does not already exist.
     * @param _otoken The identifier (token contract address) of a whitelisted otoken.
     * @return The VaultInfo struct for the now-guaranteed-to-be-valid (i.e. is whitelisted or was previously whitelisted) otoken.
     */
    function _getOrCreateVaultInfo(OtokenInterface _otoken) internal returns (VaultInfo storage) {
        if (vaults[address(_otoken)].vaultId == 0) {
            // 0 is not used as a vault ID, so this vault does not exist yet.
            // The otoken is valid (whitelisted) and has no vault, so create a vault
            vaultCount += 1;
            Actions.ActionArgs[] memory openVaultActions = new Actions.ActionArgs[](1);
            openVaultActions[0] = ActionsLib._getOpenVaultAction(address(this), vaultCount);
&nbsp;
            // Update our map and create the vault
            vaults[address(_otoken)].vaultId = vaultCount;
            opynController.operate(openVaultActions);
&nbsp;
            // If the otoken is not whitelisted it's not a real otoken and we revert.
            // We could have checked this earlier, but doing it last sidesteps reantrancy issues.
            WhitelistInterface whitelist = WhitelistInterface(opynAddressBook.getWhitelist());
            <span class="missing-if-branch" title="else path not taken" >E</span>require(whitelist.isWhitelistedOtoken(address(_otoken)), "Invalid otoken");
        }
&nbsp;
        return vaults[address(_otoken)];
    }
&nbsp;
    /**
     * @notice Increments the locked and total collateral for the LP, on the assumption that the quote will be
     * exercized.
     * @dev Does NOT check that the supplied otoken is valid, or allowed by the LP. Does NOT check that the supplied curve is allowed by the LP.
     * @dev It must only be called by internal functions that ensure the order is subsequntly fulfilled.
     * @param _seller The seller details(LP).
     * @param _collateralCalcParams Struct used to pass other inputs required for collateral calculation
     */
    function _initiatePurchaseAndUpdateFundsForOneLP(
        CounterpartyDetails memory _seller,
        CollateralCalculationParams memory _collateralCalcParams
    ) internal returns (uint256 premium, uint256 collateralAmount) {
        // Take the premium from the buyer; it's paid in the collateral token
        PoolOfCapital storage lpBal = lpPools[_seller.lp][_seller.poolId];
&nbsp;
        // Return the collateral amount
        collateralAmount = _collateralNeededForPuts(_seller.orderSizeInOtokens, _collateralCalcParams);
        premium = _premiumForLp(_seller.lp, _seller.poolId, _seller.curve, collateralAmount);
        lpBal.total = lpBal.total + premium;
        lpBal.locked = lpBal.locked + collateralAmount;
        sumOfAllUnlockedBalances = sumOfAllUnlockedBalances + premium - collateralAmount;
        sumOfAllLockedBalances = sumOfAllLockedBalances + collateralAmount;
        <span class="missing-if-branch" title="else path not taken" >E</span>require(lpBal.locked &lt;= lpBal.total, "insufficient collateral");
        return (premium, collateralAmount);
    }
&nbsp;
    /**
     * @notice The amount of capital required to collateralize a given quantitiy of a given `OToken`.
     * @dev don't introduce rounding errors. this must match the value returned by Opyn's logic, or else options will be insufcciently collateralised
     * @param _otokenQty The number of OTokens we wish to collateralize.
     * @param _collateralCalcParams Struct used to pass other inputs required for collateral calculation
     * @return The amount of collateral required, denominated in collateral tokens.
     */
    function _collateralNeededForPuts(uint256 _otokenQty, CollateralCalculationParams memory _collateralCalcParams)
        internal
        pure
        returns (uint256)
    {
        // Takes the non-expired, non-spread, selling a put case code from _getMarginRequired
        // Otoken quantities always use 8 decimals
        FPI.FixedPointInt memory shortOtokensHumanReadable = FPI.fromScaledUint(_otokenQty, OTOKEN_QTY_DECIMALS);
        FPI.FixedPointInt memory collateralNeededHumanStrikeTokens = shortOtokensHumanReadable.mul(
            _collateralCalcParams.otokenStrikeHumanReadable
        );
        // convert amount to be denominated in collateral
&nbsp;
        FPI.FixedPointInt memory collateralRequired;
        if (_collateralCalcParams.collateralMatchesStrike) {
            // No exchange rate conversion required
            collateralRequired = collateralNeededHumanStrikeTokens;
        } else {
            assert(_collateralCalcParams.collateralPrice.value &gt; 0);
            collateralRequired = _convertAmountOnLivePrice(
                collateralNeededHumanStrikeTokens,
                _collateralCalcParams.strikePrice,
                _collateralCalcParams.collateralPrice
            );
        }
&nbsp;
        return collateralRequired.toScaledUint(_collateralCalcParams.collateralTokenDecimals, false);
    }
&nbsp;
    /**
     * @notice Calculates the Premium for the supplied counterparty details.
     * @dev Does NOT check that the supplied curve is allowed. Premium calculations involve some orunding and loss of accuracy due
     * to the complex math at play. We expect the calculated premium to be within 0.1% of the correct value (i.e. the value we would
     * get in, say, python with no loss of precision) in all but a few pathological cases (e.g. util below 0.1% and multiple curve
     * parameters very near zero)
     * @param _lp The Address of the Liquidity provider.
     * @param _poolId An (LP-specific) pool identifier.
     * @param _curve The curve used to calculate the premium.
     * @param _collateralToLock The amount of collateral to lock.
     * @return premiumInCollateralTokens
     */
    function _premiumForLp(
        address _lp,
        uint256 _poolId,
        ICurveManager.Curve memory _curve,
        uint256 _collateralToLock
    ) internal view returns (uint256 premiumInCollateralTokens) {
        (
            int256 utilBeforeAs59x18,
            int256 utilAfterAs59x18,
            uint256 lockedAmountBefore,
            uint256 lockedAmountAfter
        ) = util(_lp, _poolId, _collateralToLock);
&nbsp;
        // Make sure we're not buying too large an amount, nor an amount so small that we can't calc a premium
        require(utilAfterAs59x18 &gt; utilBeforeAs59x18, "Order tranche too small");
        require(utilAfterAs59x18 &lt;= _curve.max_util_59x18, "Max util exceeded");
&nbsp;
        // The result of hyperbolicCurve tells us the premium we should have received in aggregate at any utilisation, as a percentage
        // of the aggregate locked collateral.
        // When calling hyperbolicCurve we pass in a utilisation as a fixed-point decimal (1.0 = 100% utilisation) and get back the
        // a % as a fixed point decimal (1.0 = premium should be 100% of the locked collateral).
        // To get the premium for our new order, we:
        //   1. Calculate the premium we should have received, in aggregate, BEFORE this order
        //   2. Calculate the premium we should have received, in aggregate, AFTER this order (for any non-trivial order, utilisation and
        //      collateral locked will both increase)
        //   3. Charge the buyer difference.
        uint256 premiumBefore = crv
            .hyperbolicCurve(_curve, utilBeforeAs59x18)
            .mul(PRBMathSD59x18.fromUint(lockedAmountBefore))
            .toUint();
        uint256 premiumAfter = crv
            .hyperbolicCurve(_curve, utilAfterAs59x18)
            .mul(PRBMathSD59x18.fromUint(lockedAmountAfter))
            .toUint();
        return premiumAfter - premiumBefore;
    }
&nbsp;
    /**
     * @notice Return the spot prices of assets A and B, unless A and B are the same asset
     * @param _assetA Asset A address
     * @param _assetB Asset B address
     * @return identicalAssets whether the passed assets were identical; if so, prices of 0 are returned
     * @return scaledPriceA of asset A (not set if identicalAssets=true)
     * @return scaledPriceB of asset B (not set if identicalAssets=true)
     */
    function _getLivePrices(address _assetA, address _assetB)
        internal
        view
        returns (
            bool identicalAssets,
            FPI.FixedPointInt memory scaledPriceA,
            FPI.FixedPointInt memory scaledPriceB
        )
    {
        if (_assetA == _assetB) {
            // N.B. this may be the most common case for puts
            return (true, FPI.fromUnscaledInt(0), FPI.fromUnscaledInt(0));
        }
&nbsp;
        OracleInterface oracle = OracleInterface(AddressBookInterface(opynAddressBook).getOracle());
&nbsp;
        // Oracle prices are always scaled by 8 decimals
        uint256 priceA = oracle.getPrice(_assetA);
        uint256 priceB = oracle.getPrice(_assetB);
&nbsp;
        return (
            false,
            FPI.fromScaledUint(priceA, ORACLE_PRICE_DECIMALS),
            FPI.fromScaledUint(priceB, ORACLE_PRICE_DECIMALS)
        );
    }
&nbsp;
    /**
     * @notice Convert an amount in asset A to equivalent amount of asset B, based on a live price.
     * @dev Function includes the amount and applies .mul() first to increase the accuracy.
     * @param _amount Amount in asset A.
     * @param _priceA The price of asset A, as returned by Opyn's oracle (decimals = 8), in the FixedPointInt representation of decimal numbers
     * @param _priceB The price of asset B, as returned by Opyn's oracle (decimals = 8), in the FixedPointInt representation of decimal numbers
     */
    function _convertAmountOnLivePrice(
        FPI.FixedPointInt memory _amount,
        FPI.FixedPointInt memory _priceA,
        FPI.FixedPointInt memory _priceB
    ) internal pure returns (FPI.FixedPointInt memory) {
        // amount A * price A in USD = amount B * price B in USD
        // amount B = amount A * price A / price B
        assert(_priceB.value &gt; 0);
        return _amount.mul(_priceA).div(_priceB);
    }
}
&nbsp;</pre></td></tr>
</table></pre>
<div class='push'></div><!-- for sticky footer -->
</div><!-- /wrapper -->
<div class='footer quiet pad2 space-top1 center small'>
  Code coverage
  generated by <a href="http://istanbul-js.org/" target="_blank">istanbul</a> at Thu May 05 2022 11:54:59 GMT+0200 (Central European Summer Time)
</div>
</div>
<script src="../prettify.js"></script>
<script>
window.onload = function () {
        if (typeof prettyPrint === 'function') {
            prettyPrint();
        }
};
</script>
<script src="../sorter.js"></script>
</body>
</html>
